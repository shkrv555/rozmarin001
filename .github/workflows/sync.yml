
name: ğŸš€ Auto Sync to Customer Site

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Admin Repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ”„ Sync to Customer Repo
        env:
          SYNC_TOKEN: ${{ secrets.SYNC_TOKEN }}
        run: |
          echo "ğŸ”„ Sync baÅŸladÄ±..."
          
          # Customer repo-nu klonla
          git clone https://$SYNC_TOKEN@github.com/shkrv555/rozmarin00.git customer-repo
          
          echo "âœ… Customer repo klonlandÄ±"
          
          # Admin-dÉ™n customer-É™ fayllarÄ± kopyala
          echo "ğŸ“ FayllarÄ± kopyalayÄ±ram..."
          cp -f index.html customer-repo/ || echo "âš ï¸ index.html kopyalanmadÄ±"
          [ -d "photos" ] && cp -rf photos/ customer-repo/ || echo "âš ï¸ photos qovluÄŸu yoxdur"
          [ -d "css" ] && cp -rf css/ customer-repo/ || echo "âš ï¸ css qovluÄŸu yoxdur"
          [ -d "js" ] && cp -rf js/ customer-repo/ || echo "âš ï¸ js qovluÄŸu yoxdur"
          [ -d "images" ] && cp -rf images/ customer-repo/ || echo "âš ï¸ images qovluÄŸu yoxdur"
          
          # DÉ™yiÅŸikliklÉ™ri commit et
          cd customer-repo
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          
          git add .
          if git diff-index --quiet HEAD --; then
            echo "âœ… HeÃ§ bir dÉ™yiÅŸiklik yoxdur"
          else
            git commit -m "ğŸ”„ Auto-sync: $(date +'%Y-%m-%d %H:%M:%S')"
            git push
            echo "ğŸ‰ DÉ™yiÅŸikliklÉ™r customer repo-ya gÃ¶ndÉ™rildi!"
          fi
          
          echo "âœ… Sync tamamlandÄ±!"
