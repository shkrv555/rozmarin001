name: ğŸ”§ Test SYNC_TOKEN

on:
  workflow_dispatch:  # Manual iÅŸÉ™ salmaq Ã¼Ã§Ã¼n

jobs:
  test-token:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ” Test SYNC_TOKEN Access
        env:
          SYNC_TOKEN: ${{ secrets.SYNC_TOKEN }}
        run: |
          echo "ğŸ§ª Token testi baÅŸladÄ±..."
          echo "=========================================="
          
          # 1. Tokenin boÅŸ olmadÄ±ÄŸÄ±nÄ± yoxla
          if [ -z "$SYNC_TOKEN" ]; then
            echo "âŒ XÆTA: SYNC_TOKEN BOÅDUR!"
            echo "ZÉ™hmÉ™t olmasa Settings â†’ Secrets â†’ Actions bÃ¶lmÉ™sindÉ™ SYNC_TOKEN É™lavÉ™ edin"
            exit 1
          else
            echo "âœ… SYNC_TOKEN dÉ™yÉ™ri var (gizlidir)"
          fi
          
          # 2. Token ilÉ™ repo-ya giriÅŸi yoxla
          echo "ğŸ” Repository-É™ giriÅŸi yoxlayÄ±ram..."
          if git ls-remote "https://$SYNC_TOKEN@github.com/shkrv555/rozmarin00.git" >/dev/null 2>&1; then
            echo "âœ… UGUR! Token ilÉ™ repository-É™ giriÅŸ mÃ¼mkÃ¼ndÃ¼r"
          else
            echo "âŒ XÆTA: Token ilÉ™ repository-É™ giriÅŸ MÃœMKÃœN DEYÄ°L"
            echo "SÉ™bÉ™blÉ™r:"
            echo "  - Token sÉ™hvdir"
            echo "  - Token icazÉ™lÉ™ri yoxdur"
            echo "  - Repository adÄ± sÉ™hvdir"
            exit 1
          fi
          
          # 3. Yazma icazÉ™sini yoxla
          echo "ğŸ“ Yazma icazÉ™sini yoxlayÄ±ram..."
          TEMP_DIR=$(mktemp -d)
          cd "$TEMP_DIR"
          git clone "https://$SYNC_TOKEN@github.com/shkrv555/rozmarin00.git" test-write
          cd test-write
          
          echo "test: $(date)" > test-file.txt
          git add test-file.txt
          git config user.name "GitHub Actions Test"
          git config user.email "test@github.com"
          
          if git commit -m "Test write access" && git push; then
            echo "âœ… UGUR! Token ilÉ™ yazma icazÉ™si VAR"
          else
            echo "âŒ XÆTA: Token ilÉ™ yazma icazÉ™si YOXDUR"
            exit 1
          fi
          
          echo "=========================================="
          echo "ğŸ‰ TÆBRÄ°KLÆR! TOKEN TAM Ä°ÅLÆYÄ°R!"
          echo "=========================================="
